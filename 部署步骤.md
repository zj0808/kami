# 🚀 Vercel 部署步骤（跟着做）

## 📌 当前状态
✅ 代码已准备好
✅ 已安装 @vercel/kv
✅ 已配置管理员密码：admin123

---

## 第一步：推送代码到 GitHub

### 1.1 初始化 Git（如果还没有）

打开终端，执行：

```bash
git init
```

### 1.2 添加所有文件

```bash
git add .
```

### 1.3 提交代码

```bash
git commit -m "卡密管理系统 - 准备部署"
```

### 1.4 创建 GitHub 仓库

1. 访问 https://github.com/new
2. 仓库名称：`kami`（或其他名称）
3. 选择 **Public** 或 **Private**
4. **不要**勾选 "Add a README file"
5. 点击 "Create repository"

### 1.5 推送到 GitHub

复制 GitHub 显示的命令，类似：

```bash
git remote add origin https://github.com/你的用户名/kami.git
git branch -M main
git push -u origin main
```

---

## 第二步：部署到 Vercel

### 2.1 注册/登录 Vercel

1. 访问 https://vercel.com
2. 点击右上角 "Sign Up"（如果已有账号点击 "Log In"）
3. 选择 "Continue with GitHub"
4. 授权 Vercel 访问你的 GitHub

### 2.2 导入项目

1. 登录后，点击 "Add New..." → "Project"
2. 在列表中找到 `kami` 仓库
3. 点击 "Import"

### 2.3 配置项目

在配置页面：

1. **Project Name**: 保持默认或修改（例如：`my-kami`）
2. **Framework Preset**: 自动检测为 "Next.js"
3. **Root Directory**: 保持默认 `./`
4. **Build Command**: 保持默认 `npm run build`

### 2.4 配置环境变量 ⚠️ 重要

在 "Environment Variables" 部分：

1. 点击 "Add"
2. 输入：
   - **Name**: `ADMIN_PASSWORD`
   - **Value**: `admin123`（或您想要的密码）
3. 确保选择了所有环境（Production, Preview, Development）

### 2.5 开始部署

1. 点击底部的 **"Deploy"** 按钮
2. 等待 1-2 分钟，Vercel 会自动构建和部署

---

## 第三步：创建 Vercel KV 数据库 ⚠️ 必须

部署完成后，**必须**创建 Redis 数据库：

### 3.1 进入项目

1. 部署完成后，点击 "Continue to Dashboard"
2. 或访问 https://vercel.com/dashboard

### 3.2 创建 KV 数据库

1. 在项目页面，点击顶部的 **"Storage"** 标签
2. 点击 **"Create Database"** 按钮
3. 选择 **"KV"** (Redis)
4. 配置数据库：
   - **Database Name**: `kami-kv`（或其他名称）
   - **Region**: 选择 **Hong Kong (hkg1)** 或离您最近的区域
5. 点击 **"Create"** 按钮

### 3.3 连接数据库到项目

1. 创建完成后，会看到 "Connect to Project" 页面
2. 选择您的项目（kami）
3. 点击 **"Connect"** 按钮

✅ Vercel 会自动添加以下环境变量到您的项目：
- `KV_REST_API_URL`
- `KV_REST_API_TOKEN`
- `KV_REST_API_READ_ONLY_TOKEN`

---

## 第四步：重新部署 ⚠️ 必须

配置 KV 后，**必须重新部署**才能生效：

### 4.1 触发重新部署

1. 点击顶部的 **"Deployments"** 标签
2. 找到最新的部署（第一个）
3. 点击右侧的 **"..."** 按钮
4. 选择 **"Redeploy"**
5. 在弹窗中点击 **"Redeploy"** 确认
6. 等待 1-2 分钟重新部署完成

---

## 🎉 完成！访问您的网站

部署成功后，您会看到：

### 访问地址

Vercel 会提供一个域名，例如：
- `https://kami-xxx.vercel.app`
- `https://my-kami.vercel.app`

### 测试功能

1. **访问首页**：
   - 地址：`https://你的域名.vercel.app`
   - 测试卡密验证功能

2. **访问管理后台**：
   - 地址：`https://你的域名.vercel.app/admin`
   - 密码：`admin123`（或您设置的密码）
   - 创建几个测试卡密

3. **测试批量功能**：
   - 创建 5-10 个卡密
   - 使用复选框选择
   - 测试批量复制和导出

---

## 📊 查看部署信息

在 Vercel Dashboard 可以看到：
- 📈 访问统计
- 🔍 部署日志
- ⚙️ 环境变量
- 💾 数据库状态

---

## 🔄 后续更新

以后修改代码后，只需：

```bash
git add .
git commit -m "更新说明"
git push
```

Vercel 会**自动检测并重新部署**！

---

## ⚠️ 常见问题

### Q1: 部署后显示 500 错误？
**A**: 检查是否完成了"第三步"和"第四步"（创建 KV 并重新部署）

### Q2: 管理后台密码错误？
**A**: 检查 Vercel 项目设置中的 `ADMIN_PASSWORD` 环境变量

### Q3: 创建卡密后刷新就没了？
**A**: 说明 KV 数据库没有正确连接，重新执行"第四步"

### Q4: 如何修改管理员密码？
**A**: 
1. 进入 Vercel 项目
2. Settings → Environment Variables
3. 找到 `ADMIN_PASSWORD`，点击编辑
4. 修改后重新部署

---

## 📞 需要帮助？

如果遇到问题：
1. 查看 Vercel 部署日志
2. 检查环境变量是否正确配置
3. 确认 KV 数据库已创建并连接

---

**祝您部署顺利！🎉**

